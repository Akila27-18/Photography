{% if grouped_sessions %}

    {% for month, projects in grouped_sessions.items %}
        <h3 class="month-title">{{ month }}</h3>

        {% for project in projects %}

        <div class="session-card 
            {% if project.status == 'pre_production' or project.status == 'post_production' %}in-progress{% else %}pending{% endif %}"
            data-url="{% if project.status == 'pre_production' or project.status == 'post_production' %}{% url 'projects:project_sessions' project.id %}{% else %}{% url 'projects:board' %}{% endif %}"
            role="button"
            tabindex="0"
        >

            <!-- DATE -->
            <div class="date-section">
                <div class="day">{{ project.start_date|date:"D"|default:"TBD" }}</div>
                <div class="date">{{ project.start_date|date:"d"|default:"--" }}</div>
            </div>

            <div class="divider"></div>

            <!-- TIME + VENUE -->
            <div class="time-block">
                <div class="time-row">
                    ‚è∞ {{ project.time|time:"h:i A"|default:"TBD" }}
                </div>
                <div class="venue-row">
                    üìç {{ project.venue|default:"TBD" }}
                </div>
            </div>

            <!-- TITLE + TEAM -->
            <div class="content-block">
                <div class="title-block">
                    {{ project.client_name }} {{ project.event_type }}
                </div>

                <div class="team-block">
                    {% if project.team.exists %}
                        <div class="avatars">
                            {% for member in project.team.all|slice:":5" %}
                                <div class="avatar" title="{{ member.get_full_name|default:member.username }}">
                                    {{ member.username|slice:":2"|upper }}
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <a href="{% url 'projects:board' %}"
                           class="assign-team-btn"
                           onclick="event.stopPropagation();">
                            + Assign Team
                        </a>
                    {% endif %}
                </div>
            </div>

            <!-- STATUS -->
            <div class="status-block">
                {% if project.status == "pre_production" or project.status == "post_production" %}
                    <span class="status-badge progress">In-Progress</span>
                {% else %}
                    <span class="status-badge pending-badge">Pending</span>
                {% endif %}
            </div>

        </div>

        {% endfor %}
    {% endfor %}

{% else %}
    <p class="empty-text" style="text-align: center;">No sessions available.</p>
{% endif %}
